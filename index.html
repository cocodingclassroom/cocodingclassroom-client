<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="description" content="COCODING Classroom" />
		<title>COCODING Classroom</title>
		<link rel="stylesheet" href="styles.css">

		<script src="includes/js/cc-auth.js"></script>
		<script src="includes/js/split.min.js"></script>
		<script src="includes/js/diff.min.js"></script>
		<script src="includes/js/name_generator.js"></script>
		<script src="includes/js/loopBreaker.min.js"></script>
		<script src="includes/js/beautify.min.js"></script>
		<script src="includes/js/marked.min.js"></script>

		<link rel="stylesheet" href="includes/js/vex/vex.css" />
		<link rel="stylesheet" href="includes/js/vex/vex-theme-plain.css" />
		<script src="includes/js/vex/vex.combined.min.js"></script>

		<script src="includes/js/ace-diff/ace-diff.min.js"></script>
		<link href="includes/js/ace-diff/ace-diff.min.css" rel="stylesheet">
		<link href="includes/js/ace-diff/ace-diff-dark.min.css" rel="stylesheet">

	</head>
	<body>

		<!-- CLASSROOM SETUP -->
		<div id="setup">
			COCODING CLASSROOM – SETUP<hr>
			<!-- <input id="setup-classroom" type="text" name="" placeholder="classroom"> -->

			<div class="setup-div" data-tip="Room count (can add more later)" data-tip-right>
				<select id="setup-rooms"></select> Rooms
			</div>


			<!-- <select id="setup-binding" style="width:80px;">
				<option value="p5">p5.js</option>
				<option value="hydra">hydra</option>
			</select> Binding<br><br> -->

			<div class="setup-div" data-tip="Auto compile code with __ sec delay on keyup" data-tip-right>

				<input id="setup-livecoding" class="cc-setting-checkbox" type="checkbox" checked> Live Coding	w/
				<select id="setup-livedelay" class="cc-settings-livedelay">
					<option>0.5</option>
					<option selected>1.0</option>
					<option>1.5</option>
					<option>2.0</option>
				</select> sec delay

			</div>
			<div class="setup-div" data-tip="Display code line numbers" data-tip-right>
				<input id="setup-linenumbers" class="cc-setting-checkbox" type="checkbox" checked> Line Numbers
			</div>
			<div class="setup-div" data-tip="Allow peers to lock their room" data-tip-right>
				<input id="setup-roomlocks" class="cc-setting-checkbox" type="checkbox"> Room Locks
			</div>

			<div class="setup-div" data-tip="Require password to enter Classroom" data-tip-right>
				<input id="setup-password" type="text" name="" placeholder="(optional)" onkeyup="javascript: if(event.keyCode == 13) cc.classroomSetup()" > Password
			</div>

			<button class="setup-button" onclick="cc.classroomSetup()">CREATE CLASSROOM</button>
		</div>

		<!-- AUTH IF PASSWORD -->
		<div id="auth">
			COCODING CLASSROOM – LOGIN<hr>

			<input id="auth-password" type="text" name="" placeholder="password" onkeyup="javascript: if(event.keyCode == 13) cc.auth()"> <br><br>
			<button onclick="cc.auth()">LOGIN</button>
		</div>

		<!-- COMPARE CODE -->
		<div id="merge-holder" onclick="cc.mergeClose()">
			<div class="merge-nav">
				<div data-tippy-content="Cancel" onclick="">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-minus-circle"><circle cx="12" cy="12" r="10"></circle><line x1="8" y1="12" x2="16" y2="12"></line></svg>
				</div>
				<div data-tippy-content="Merge" onclick="cc.mergeCode();event.stopPropagation();">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
				</div>
			</div>
			<div id="merge-compare" class="merge-compare" onclick="event.stopPropagation();"></div>
		</div>


		<!-- MAIN / ROOMS -->
		<div id="rooms">
			<div id="room-a"></div>
			<div id="room-b"></div>
		</div>


		<!-- EARLY ACCESS -->
		<div id="earlyaccess">
			COCODING Classroom<hr style="outline:none !important;border:1px solid #fff;">
			<a href="https://forms.gle/n9eGtDHvsrLbA6DR8" target="_blank" class="pulse-slow" style="color: #fff;text-decoration: none;font-style: italic;">Sign-up for Early Access</a>
			<br><br>
			<div id="earlyaccess-youtube"></div>

		<!-- DRAG + DROP AUTH -->
		<div id="drop_zone" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);" ondragleave="dragLeaveHandler(event);"></div>

		</div>

		<!-- LOAD MAGIC -->
		<script type="module" src="index.js?24" crossorigin></script>

		<!-- MOVE TO INDEX.JS? -->
		<script type="text/javascript">
			let drop = document.getElementById('drop_zone')
			function dropHandler(ev) {
			  ev.preventDefault();

			  let reader = new FileReader();
				reader.onload = function(data) {

					try {
			        a = JSON.parse(reader.result);
			    } catch(e) {
			        drop.style.background = 'none'
			        return
			    }

					let tAuth = JSON.parse(reader.result);
					if(tAuth.hasOwnProperty('authToken')){
						localStorage.setItem('cc-auth', tAuth.authToken)
						location.reload()
					}else{
						// error handle here
						drop.style.background = 'none'
						// report error as div
					}
				}

			  if (ev.dataTransfer.items) {
			    for (var i = 0; i < ev.dataTransfer.items.length; i++) {
			      if (ev.dataTransfer.items[i].kind === 'file') {
			        var file = ev.dataTransfer.items[i].getAsFile();
			        reader.readAsText(file);
			      }
			    }
			  }
			}

			function dragOverHandler(ev) {
			  ev.preventDefault();
			  drop.style.background = 'rgba(0, 255, 0, .25)'
			}

			function dragLeaveHandler(ev) {
			  ev.preventDefault();
			  drop.style.background = 'rgb(0, 0, 0)'
			}
		</script>
	</body>
</html>